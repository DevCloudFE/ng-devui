<ng-container *ngrxLet="parentMenu.collapsed$ as collapsed">
  <div [class]="titleCls('devui-sub-menu-item')" d-menu-item (itemClick)="titleClick()" cdkOverlayOrigin #trigger="cdkOverlayOrigin">
    <div class="devui-sub-menu-item-title" role="menu" *strTplOutlet="title; context: titleContext">
      <ng-content select="[title]" *ngIf="!title" />
      <d-icon class="devui-menu-item-icon" *ngIf="icon" [disabled]="disabled" [icon]="icon" />
      <span class="devui-menu-item-name over-flow-ellipsis" [title]="title">{{ title }}</span>
    </div>

    <div class="devui-sub-menu-item-arrow">
      <d-icon class="devui-menu-item-icon" [disabled]="disabled" icon="icon-select-arrow" />
    </div>
  </div>

  <ng-container *ngIf="collapsed; else defaultChildrenTpl">
    <!-- 
cdkConnectedOverlayHasBackdrop
    cdkConnectedOverlayBackdropClass="devui-menu-popover-backdrop"

     -->
    <ng-template
      cdkConnectedOverlay
      cdkConnectedOverlayPanelClass="devui-menu-popover-panel"
      [cdkConnectedOverlayOrigin]="trigger"
      [cdkConnectedOverlayOpen]="open"
      [cdkConnectedOverlayPositions]="positions"
    >
      <div class="devui-menu-popover">
        <ng-template [ngTemplateOutlet]="contentTpl" />
      </div>
    </ng-template>
  </ng-container>

  <ng-template #defaultChildrenTpl>
    <div class="devui-sub-menu-children" [style.--level]="submenuService.level" [@collapseMotion]="expandState">
      <ng-template [ngTemplateOutlet]="contentTpl" />
    </div>
  </ng-template>

  <ng-template #contentTpl>
    <ng-content />
  </ng-template>
</ng-container>
